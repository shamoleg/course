# Введение в GNU / Linux

Linux - семейство Unix-подобных операционных систем на базе ядра Linux, включающих тот или иной набор утилит и программ проекта GNU, и,  другие компоненты. Как и ядро Linux, системы на его основе как правило создаются и распространяются в соответствии с моделью разработки свободного и открытого программного обеспечения.

Linux работает на множестве процессоров различных архитектур, таких как x86, x86-64, PowerPC, ARM, RISC-V, Alpha AXP, SPARC, Motorola 680x0, SuperH, IBM System/390, MIPS, PA-RISC, AXIS CRIS, Renesas M32R, Atmel AVR32, Renesas H8/300, NEC V850, Tensilica Xtensa, «Эльбрус» и многих других.

В отличие от коммерческих систем, таких как Windows или macOS, Linux не имеет географического центра разработки. Нет и организации, которая владела бы этой системой. Linux — результат работы тысяч проектов. Некоторые из этих проектов централизованы, некоторые сосредоточены в фирмах. Многие проекты объединяют хакеров со всего света, которые знакомы только по переписке. Создать свой проект или присоединиться к уже существующему может любой и, в случае успеха, результаты работы станут известны миллионам пользователей. Пользователи принимают участие в тестировании свободных программ, общаются с разработчиками напрямую, что позволяет быстро находить и исправлять ошибки и реализовывать новые возможности.

По состоянию на середину 2010-х годов системы Linux лидируют на рынках серверов (60 %), являются превалирующими в дата-центрах предприятий и организаций (согласно Linux Foundation), занимают половину рынка встраиваемых систем, имеют значительную долю рынка нетбуков (32 % на 2009 год). На рынке персональных компьютеров Linux стабильно занимает 3-е место (по разным данным, от 1 до 5 %). Согласно исследованию Goldman Sachs, в целом, рыночная доля Linux среди электронных устройств составляет около 42 %.

В нашем курсе мы будем использовать Ubuntu - дистрибутив Linux, основанный на Debian GNU/Linux.

Работа в графической оболочке интуитивно понятна и походит на работу в операционных системах Windows, поэтому останавливаться на этом не будем.

## Структура файловой системы Ubuntu

Ubuntu поддерживает стандарт FHS(File System Hierarchy Standard), описывающий какая информация должна находится в том или ином месте «дерева». Ниже приведена таблица основных директорий с кратким описанием .

| Директория  | Описание |
| ------------| ---------|
| /      | Корневая директория, содержащая всю файловую иерархию. |
| /home/ | Содержит домашние директории пользователей.|
| /opt/  | Дополнительное программное обеспечение. |
| /dev/  | Основные файлы устройств системы. |
| /bin/  | Основные системные утилиты. |
| /boot/ | Загрузочные файлы (в том числе файлы загрузчика, ядро и т.д.).|

## BASH

Shell - это инструмент, который позволяет вам общаться с системой Linux, чтобы сообщить ей, что делать (путем отправки команд).

Bourne-Again SHell, усовершенствованная и модернизированная вариация командной оболочки Bourne shell. Одна из наиболее популярных современных разновидностей командной оболочки UNIX.

При входе в систему для всех пользователей, выполняются команды, содержащиеся в файлах `/etc/profile` и `$HOME/.profile`.

Файл `/etc/profile` позволяет администратору системы выполнить обслуживающие действия для всех пользователей.

Файл `~/.profile` используется для установки нужных конкретному пользователю переменных окружения и характеристик терминала.

Когда запускается интерактивная оболочка, которая не является оболочкой входа в систему, bash читает и выполняет команды `~/.bashrc`

## Terminal

Большинство пользователей привыкло работать на компьютере, кликая на иконки и выбирая нужные пункты меню. Однако есть и другой подход, который позволяет отдавать команды компьютеру, вводя их в специальную программу под названием терминал.

Для того чтобы открыть терминал необходимо кликнуть на иконку или нажать сочетание клавиш `ctrl+alt+T`

## Основные команды которые потребуются в контексте данного курса

### **pwd** (print working directory)

Вывести текущую директорию

```console
~$ pwd
/home/olegsham
```

### **ls** (list directory content)

Вывести содержимое директории. Если не передать путь, то выведется содержимое текущей директории.

```console
~$ ls
catkin_ws      Desktop    education          Music     Public   Templates
CLionProjects  Documents  exampl.txt         Pictures  res.txt  Video
desktop        Downloads  genicam_xml_cache  program   snap     youbot
~$ ls catkin_ws/
build  devel  src
~$ ls -l catkin_ws/
итого 12
drwxr-xr-x 20 olegsham olegsham 4096 мар 11 15:36 build
drwxr-xr-x  6 olegsham olegsham 4096 мар 10 02:18 devel
drwxr-xr-x  9 olegsham olegsham 4096 мар 11 18:12 src

```

Сосредоточимся на первой части, которая называется `drwxr-xr-x`. Это РАЗРЕШЕНИЯ файла.

Каждый файл или каталог имеет 3 типа разрешений:

- **Чтение:** разрешение на чтение относится к возможности пользователя читать содержимое файла. Он указывается с помощью символа `r`.
- **Запись:** разрешение на запись относится к возможности пользователя записывать или изменять файл или каталог. Он указывается с помощью символа `w`.
- **Выполнить:** разрешение «Выполнить» влияет на возможность пользователя выполнять файл или просматривать содержимое каталога. Он указывается с помощью символа `x`.

С другой стороны, каждый файл или каталог имеет три пользовательские группы разрешений:

- **Владелец:** разрешения владельца применяются только к владельцу файла или каталога и не влияют на действия других пользователей. Они представлены в первых 3 символах.
- **Группа:** разрешения группы применяются только к группе, которая была назначена файлу или каталогу, и не влияют на действия других пользователей. Они представлены тремя средними символами.
- **Все пользователи:** разрешения применяются ко всем остальным пользователям в системе. Они представлены в последних 3 символах.

### **chmod**

Изменение прав доступа

```console
~$ chmod 777 catkin_ws/build
~$ ls -l catkin_ws/
итого 12
drwxrwxrwx 20 olegsham olegsham 4096 мар 11 15:36 build
drwxr-xr-x  6 olegsham olegsham 4096 мар 10 02:18 devel
drwxr-xr-x  9 olegsham olegsham 4096 мар 11 18:12 src
```

### **cd**

Сменить директорию

```console
~$ pwd
/home/olegsham
~$ cd catkin_ws/src/
~/catkin_ws/src$ pwd
/home/olegsham/catkin_ws/src
```

### **mkdir**

создать директорию.

```console
~/catkin_ws/src$ ls
CMakeLists.txt
~/catkin_ws/src$ mkdir courcebot
~/catkin_ws/src$ ls
CMakeLists.txt  courcebot
```

### **touch**

создать файл.

```console
~/catkin_ws/src$ ls
CMakeLists.txt  courcebot
~/catkin_ws/src$ touch readme.txt
~/catkin_ws/src$ ls
CMakeLists.txt  courcebot  readme.txt
```

### **сp**

копировать файл

```console
~/catkin_ws/src$ ls
CMakeLists.txt  courcebot  readme.txt
~/catkin_ws/src$ cp readme.txt courcebot/
~/catkin_ws/src$ ls courcebot/
readme.txt
```

### **rm**

удалить файл

```console
~/catkin_ws/src/courcebot$ ls
readme.txt
~/catkin_ws/src/courcebot$ rm readme.txt 
~/catkin_ws/src/courcebot$ ls
```

### **mv**

переместить файл

```console
~/catkin_ws/src$ mv readme.txt courcebot/
~/catkin_ws/src$ ls
CMakeLists.txt  courcebot
~/catkin_ws/src$ ls courcebot/
readme.txt
```

### **echo**

Вывести строку

```console
~/catkin_ws/src$ echo hi
hi
```

## Горячии главиши для работы в командной строке

| Сочетание клавиш  | Описание |
| ------------| ---------|
|**🠕, 🠗** | Перемещение по командам введенным ранее.|
|**🠖, 🠔** | Перемещение по команде.|
|**Ctrl + A** | Перевод коретки в начало.|
|**Ctrl + E** | Перевод коретки в конец.|
|**Ctrl + Shift + C** | Копирование выделленного текста.|
|**Ctrl + Shift + V** | Вставка текста.|
|**Tab** | Подстановка |
|**Tab, Tab** | Показ возможныч постановок |

## Специальные симовы

| Символ | Описание |
| ------------| ---------|
|**.** | Текущее состояние |
|**..** | Директория на уровень выше |
|**~** | Домашняя директория($HOME) |

## Переменные среды

Переменная среды - это значение с динамическим именем, которое может влиять на поведение запущенных процессов на компьютере.

Они являются частью среды, в которой выполняется процесс. Например, запущенный процесс может запросить значение переменной среды TEMP, чтобы найти подходящее место для хранения временных файлов, или переменную HOME, чтобы найти структуру каталогов, принадлежащую пользователю, запускающему процесс.

Переменные среды устанавливаются при открытии нового сеанса Shell. Если вы измените какое-либо значение переменной во время сеанса оболочки, оболочка не сможет уловить это изменение. Команда `export` предоставляет возможность обновить текущий сеанс оболочки изменении, которое вы внесли в экспортируемую переменную. Вам не нужно ждать нового сеанса Shell, чтобы использовать значение измененной вами переменной. Фактически, это именно то, что мы сделали в предыдущем разделе.

## Настройка рабочего окружения для разработки мобильного робота и взаимодействия с сенсорами

ROS (Robot Operating System) — Операционная система для роботов — это экосистема для программирования роботов, предоставляющий функциональность для распределенной работы. ROS был первоначально разработан в 2007 году под названием switchyard в Лаборатории Искусственного Интеллекта Стэнфордского Университета.

ROS обеспечивает стандартные службы операционной системы, такие как: аппаратную абстракцию, низкоуровневый контроль устройств, реализацию часто используемых функций, передачу сообщений между процессами, и управление пакетами. ROS основан на архитектуре графов, где обработка данных происходит в узлах, которые могут получать и передавать сообщения между собой. Библиотека ориентирована на Unix-подобные системы (Ubuntu Linux включен в список «поддерживаемых», в то время как другие варианты, такие как Fedora и Mac OS X, считаются «экспериментальными»).

## Установка ROS

Добавим репозиторий пакетов ROS.

```console
sudo sh -c 'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" > /etc/apt/sources.list.d/ros-latest.list'
```

Настроим ключ

```console
sudo apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654
```

Обновим список доступных репозиториев и обновим установленные пакеты

```console
sudo apt-get update 
sudo apt-get upgrade
```

Для обучения лучше всего установить полную версию системы содержащую: ROS, rqt, rviz, robot-generic libraries, 2D/3D simulators and 2D/3D perception

```console
sudo apt install ros-melodic-desktop-full
```

Настройка рабочих параметров ROS, происходит через установку переменных окружения. Для  автоматического экспорта при запуске интерактивной оболочки bash(открытия терминала) добавим команду в ~/.bashrc

```console
echo "source /opt/ros/melodic/setup.bash" >> ~/.bashrc
source ~/.bashrc
```

Для создания и управления собственными рабочими пространствами ROS существуют различные инструменты , которые распространяются отдельно. Их тоже необходимо установить.

```console
sudo apt-get install python-rosinstall python-rosinstall-generator python-wstool build-essential
```

Прежде чем вы сможете использовать многие инструменты ROS, вам нужно будет инициализировать rosdep. rosdep позволяет легко устанавливать системные зависимости для исходного кода, который вы хотите скомпилировать, и требуется для запуска некоторых основных компонентов в ROS.

```console
sudo apt install python-rosdep
sudo rosdep init
rosdep update
```

На этом установка ROS завершена.

## Установка VScode

Для разработки нам также потребуется редактор исходного кода. Один из самых удобных инструментов является VScod, для ехо установке нам потребуется менеджер пакетов snap.

```console
sudo apt install snapd
```

Далее идет непостредственно установка VScode

```console
sudo snap install --classic code
```

Для запуска достаточно в ввести терменале

```console
code
```

Для работы с ROS необходимо установить расширения

- Python by Microsoft (ms-python.python)
- C/C++ by Microsoft (ms-vscode.cpptools)
- CMake by twxs (twxs.cmake)
- ROS by Microsoft  (ms-iot.vscode-ros)
